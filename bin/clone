#!/usr/bin/env bash
set -euo pipefail
IFS=$'\n\t'

if [ "$#" -lt 1 ]; then
    echo "Usage: $(basename "$0") <git-repo-url>"
    exit 1
fi

REPO_URL="$1"

if [[ "$REPO_URL" =~ ^git@([^:]+):(.+)\.git$ ]]; then
  # SSH format: git@domain.com:path/to/repo.git
  DOMAIN="${BASH_REMATCH[1]}"
  PATH_PART="${BASH_REMATCH[2]}"
elif [[ "$REPO_URL" =~ ^https?://([^/]+)/(.+)\.git$ ]]; then
  # HTTPS format: https://domain.com/path/to/repo.git
  DOMAIN="${BASH_REMATCH[1]}"
  PATH_PART="${BASH_REMATCH[2]}"
else
  echo "Unsupported Git URL format: $REPO_URL"
  exit 1
fi

TARGET_DIR="$HOME/Documents/$DOMAIN/$PATH_PART"

mkdir -p "$(dirname "$TARGET_DIR")"
git clone "$REPO_URL" "$TARGET_DIR"
